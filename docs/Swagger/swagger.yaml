openapi: 3.0.0
info:
  title: API
  version: 1.0.0
  description: API
servers:
  - url: http://127.0.0.1:8000
paths:
  /v1/member/login:
    post:
      tags:
        - Member
      summary: Member login
      description: Normal Login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: admin
                password:
                  type: string
                  example: admin
              required:
                - username
                - password
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDY3OTMzMTJ9.YoSa8QjqZ8jUUhMWHzsNTsrgMt5YmxQuey0vBwTKV6s"
                  refresh_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDczOTA5MTJ9.8l9dcqj63c1RJfE8Bkb2X_eqs4TCn7qcAxI3PvjeqP4"
        "400":
          description: |
            Login failed<br>
            [ status_code ENUM ]<br>
            missing-mandatory-parameter<br>
            invalid-username-or-password<br>
            [ errors ENUM ]<br>
            username<br>
            password<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /v1/member/social-login:
    post:
      tags:
        - Member
      summary: Member social login
      description: Social Login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - provider
                - token
              properties:
                provider:
                  type: integer
                  enum: [2, 3, 4] # 2: KAKAO, 3: NAVER, 4: GOOGLE
                  example: 2
                token:
                  type: string
                  example: "gyYwO9GsLD30O1T7Sg"
      responses:
        "200":
          description: Social login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDY3OTMzMTJ9.YoSa8QjqZ8jUUhMWHzsNTsrgMt5YmxQuey0vBwTKV6s"
                  refresh_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDczOTA5MTJ9.8l9dcqj63c1RJfE8Bkb2X_eqs4TCn7qcAxI3PvjeqP4"
        "400":
          description: |
            Social Login failed<br>
            [ status_code ENUM ]<br>
            missing-mandatory-parameter<br>
            social-token-error<br>
            [ errors ENUM ]<br>
            provider<br>
            token<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /v1/member/social-sign-up:
    post:
      tags:
        - Member
      summary: Member social signup
      description: Social signup
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - provider
                - token
                - jobs_info
              properties:
                provider:
                  type: integer
                  enum: [2, 3, 4] # 2: KAKAO, 3: NAVER, 4: GOOGLE
                  example: 2
                token:
                  type: string
                  example: "gyYwO9GsLD30O1T7Sg"
                jobs_info:
                  type: array
                  nullable: true
                  items:
                    type: object
                    properties:
                      job_id:
                        type: integer
                        example: 1
                      start_date:
                        type: string
                        example: "2024-05-01"
                      end_date:
                        type: string
                        nullable: true
                        example: "2024-06-30"

      responses:
        "200":
          description: Social signup successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDY3OTMzMTJ9.YoSa8QjqZ8jUUhMWHzsNTsrgMt5YmxQuey0vBwTKV6s"
                  refresh_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDczOTA5MTJ9.8l9dcqj63c1RJfE8Bkb2X_eqs4TCn7qcAxI3PvjeqP4"
        "400":
          description: |
            Social Login failed<br>
            [ status_code ENUM ]<br>
            missing-mandatory-parameter<br>
            social-token-error<br>
            [ errors ENUM ]<br>
            provider<br>
            token<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /v1/member/refresh-token:
    post:
      tags:
        - Member
      summary: Refresh access token
      description: Refreshes the access token using a refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refresh_token
              properties:
                refresh_token:
                  type: string
                  example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDczOTI1NTZ9.PVuMlaXns3mUW9QYWuD1qa0Et66i1A0RgLby78hs90c"
      responses:
        "200":
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDY3OTQ5NTZ9.u9aHwyOhd_7arlbDGgmo-2j9LqKU3WK7VH5P0A6Q5C8"
                  refresh_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6MSwibWVtYmVyX2lkIjoxLCJleHAiOjE3MDczOTI1NTZ9.PVuMlaXns3mUW9QYWuD1qa0Et66i1A0RgLby78hs90c"
        "400":
          description: |
            Refresh Token failed<br>
            [ status_code ENUM ]<br>
            missing-mandatory-parameter<br>
            [ errors ENUM ]<br>
            refresh_token<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

        "401":
          description: |
            Social Login failed<br>
            [ status_code ENUM ]<br>
            invalid-refresh-token<br>
            [ errors ENUM ]<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /v1/member/guest-token:
    post:
      tags:
        - Member
      summary: Generate guest token
      description: Generates a new access token and refresh token for a guest user
      responses:
        "200":
          description: Tokens generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6NCwibWVtYmVyX2lkIjpudWxsLCJleHAiOjE3MDY3OTU0MDJ9.OrdHI8qt6bVx343K6yg5wqmHSfGZ_c_t4GKFPdJ3Khg"
                  refresh_token:
                    type: string
                    example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJndWVzdF9pZCI6NCwibWVtYmVyX2lkIjpudWxsLCJleHAiOjE3MDczOTMwMDJ9.TJw6jktUuwWmgsc1MBmAtNKe15ASsLzJ4pgPNGtQX3g"

  /v1/member/sign-up-validation:
    post:
      tags:
        - Member
      summary: Validate user registration information
      description: Validates the given user registration information for uniqueness and conformity.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - email
                - nickname
                - password1
                - password2
              properties:
                username:
                  type: string
                  example: "test"
                email:
                  type: string
                  format: email
                  example: "test@naver.com"
                nickname:
                  type: string
                  example: "test"
                password1:
                  type: string
                  example: "testtest"
                password2:
                  type: string
                  example: "testtest"
      responses:
        "200":
          description: Validation successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "success"
        "400":
          description: |
            SignUp Validation failed<br>
            [ status_code ENUM ]<br>
            missing-mandatory-parameter<br>
            invalid-sign-up-field-value<br>
            [ errors ENUM ]<br>
            username<br>
            email<br>
            nickname<br>
            password1<br>
            password2<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /v1/member/sign-up-check:
    post:
      tags:
        - Member
      summary: Send verification code to email
      description: Validates user input and sends a verification code to the user's email if the input is valid.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - username
                - nickname
                - password2
              properties:
                email:
                  type: string
                  format: email
                  example: "test@naver.com"
                username:
                  type: string
                  example: "username"
                nickname:
                  type: string
                  example: "nickname"
                password2:
                  type: string
                  example: "password2"
      responses:
        "200":
          description: Verification code sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "인증번호를 이메일로 전송했습니다."

        "400":
          description: |
            Error sending verification code or invalid input<br>
            [ status_code ENUM ]<br>
            missing-mandatory-parameter<br>
            sending-email-token-error<br>
            [ errors ENUM ]<br>
            email<br>
            username<br>
            nickname<br>
            password1<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /v1/member/sign-up-validate-token:
    post:
      tags:
        - Member
      summary: Validate one-time token for email verification
      description: Validates the one-time token sent to the user's email as part of the registration process.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - one_time_token
              properties:
                email:
                  type: string
                  format: email
                  example: "test@naver.com"
                one_time_token:
                  type: string
                  example: "one_time_token"
      responses:
        "200":
          description: Registration successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "회원가입에 성공했습니다."
        "400":
          description: |
            Validation error or registration failure<br>
            [ status_code ENUM ]<br>
            missing-mandatory-parameter<br>
            member-creation-fail<br>
            email-token-macro-error<br>
            invalid-email-token<br>
            email-token-expired<br>
            [ errors ENUM ]<br>
            email<br>
            one_time_token<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /v1/product/point:
    get:
      tags:
        - Product
      summary: List points products with pagination
      description: Retrieve a paginated list of points products.
      parameters:
        - in: query
          name: page
          required: true
          schema:
            type: integer
            default: 1
          description: Page number of the product listing.
        - in: query
          name: size
          required: true
          schema:
            type: integer
            default: 20
          description: Number of products per page.
      responses:
        "200":
          description: A list of points products
          content:
            application/json:
              schema:
                type: object
                properties:
                  products:
                    type: array
                    items:
                      type: object
                      properties:
                        product_id:
                          type: integer
                          example: 1
                        product_type:
                          type: string
                          example: "POINT"
                        title:
                          type: string
                          example: "G-point 1000"
                        description:
                          type: string
                          example: "G-point 1000"
                        price:
                          type: integer
                          example: 1000
                        point:
                          type: integer
                          example: 1000
                        is_sold_out:
                          type: boolean
                          example: false
                        bought_count:
                          type: integer
                          example: 0
                        review_count:
                          type: integer
                          example: 0
                        review_rate:
                          type: number
                          format: float
                          example: 0.0

  /v1/payment/product/buy/kakao:
    post:
      tags:
        - Kakao Payment
      summary: Purchase a product using Kakao Pay
      description: Initiates a product purchase transaction using Kakao Pay.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - product_id
                - product_type
                - quantity
                - payment_type
                - order_phone_number
              properties:
                product_id:
                  type: integer
                  example: 1
                product_type:
                  type: string
                  enum: [POINT]
                  example: "POINT"
                quantity:
                  type: integer
                  example: 10
                payment_type:
                  type: string
                  enum: [KAKAO]
                  example: "KAKAO"
                order_phone_number:
                  type: string
                  example: "01074686889"
      responses:
        "200":
          description: Purchase initiated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  tid:
                    type: string
                    example: "T5bef4ed1c025b0f886f"
                  next_redirect_app_url:
                    type: string
                    example: "https://online-pay.kakao.com/mockup/v1/1061874fa483485aeaf2f25cc35faf7651fafc55fb5aedccbc5a3b38f2639146/aInfo"
                  next_redirect_mobile_url:
                    type: string
                    example: "https://online-pay.kakao.com/mockup/v1/1061874fa483485aeaf2f25cc35faf7651fafc55fb5aedccbc5a3b38f2639146/mInfo"
                  next_redirect_pc_url:
                    type: string
                    example: "https://online-pay.kakao.com/mockup/v1/1061874fa483485aeaf2f25cc35faf7651fafc55fb5aedccbc5a3b38f2639146/info"
        "400":
          description: Error due to invalid input or token format
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              examples:
                invalid_token_format:
                  value:
                    message: "잘못된 토큰 형식입니다."
                invalid_input:
                  value:
                    message: "입력값을 다시 확인해주세요."

  /v1/payment/product/approve/kakao/{order_id}:
    get:
      tags:
        - Kakao Payment
      summary: Approve Kakao Pay payment
      description: Finalizes the payment process for an order using Kakao Pay.
      parameters:
        - in: path
          name: order_id
          required: true
          schema:
            type: string
          description: The order ID to be approved.
        - in: query
          name: pg_token
          required: true
          schema:
            type: string
          description: The pg_token obtained from Kakao Pay.
      responses:
        "200":
          description: Payment approved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "결제가 완료되었습니다."
        "400":
          description: Error due to invalid order or payment failure
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              examples:
                non_existent_order:
                  value:
                    message: "존재하지 않는 주문입니다"
                payment_failure:
                  value:
                    message: "카카오페이 결제에 실패하였습니다."

  /v1/payment/product/cancel/kakao/{order_token}:
    post:
      tags:
        - Kakao Payment
      summary: Cancel Kakao Pay payment
      description: Cancels a payment process for an order using Kakao Pay.
      parameters:
        - in: path
          name: order_token
          required: true
          schema:
            type: string
          description: The order token of the payment to be canceled.
      responses:
        "200":
          description: Payment canceled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "결제가 취소되었습니다."
        "400":
          description: Error due to invalid input or other issues
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              examples:
                invalid_input:
                  value:
                    message: "입력값을 다시 확인해주세요."
                non_existent_order:
                  value:
                    message: "존재하지 않는 주문입니다."
                already_cancelled:
                  value:
                    message: "이미 취소된 주문입니다."
                invalid_order_state:
                  value:
                    message: "주문의 상태가 유효하지 않습니다."
                kakao_pay_cancellation_failure:
                  value:
                    message: "카카오페이 결제 취소에 실패하였습니다."

  /v1/common/health-check:
    get:
      tags:
        - Common
      summary: Health Check API
      description: To check health check
      responses:
        "200":
          description: Health Check successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "OK"

  /v1/common/image/{constance_type}/{transaction_pk}/url:
    post:
      tags:
        - Common
      summary: Give Presigned Url
      description: To upadte aws S3 image
      parameters:
        - in: path
          name: constance_type
          required: true
          schema:
            type: string
            enum: ["member-image"]
          description: Type of constance_type
        - in: path
          name: transaction_pk
          required: true
          schema:
            type: string
          description: Type of constance_type pk
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - file_name
              properties:
                file_name:
                  type: string
                  description: "파일 이름 확장자까지 요"
                  example: "test.png"
      responses:
        "200":
          description: Created Presigned URL
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    example: "https://s3-bucket-url.com"
                  data:
                    type: object
                    properties:
                      key:
                        type: string
                        example: "project-image/1/test.png"
                      x-amz-algorithm:
                        type: string
                        example: "AWS4-HMAC-SHA256"
                      x-amz-credential:
                        type: string
                        example: "......./20240720/ap-northeast-2/s3/aws4_request"
                      x-amz-date:
                        type: string
                        example: "20240720T054525Z"
                      policy:
                        type: string
                        example: "eyJleHBpcmF0aW9uIjogIjIwMjQtMDctMjBUMDY6MDI6MDVaIiwgImNvbmRpdGlvbnMiOiBbWyJjb250ZW50LWxlbmd0aC1yYW5nZSIsIDAsIDEwNDg1NzYwXSwgeyJidWNrZXQiOiAic2lwbGUtZGV2In0sIHsia2V5IjogInByb2plY3QtaW1hZ2UvMS90ZXN0LnBuZyJ9LCB7IngtYW16LWFsZ29yaXRobSI6ICJBV1M0LUhNQUMtU0hBMjU2In0sIHsieC1hbXotY3JlZGVudGlhbCI6ICJBS0lBMlVDM0ZHUTZaNU5NUkJZUS8yMDI0MDcyMC9hcC1ub3J0aGVhc3QtMi9zMy9hd3M0X3JlcXVlc3QifSwgeyJ4LWFtei1kYXRlIjogIjIwMjQwNzIwVDA1NDUyNVoifV19"
                      x-amz-signature:
                        type: string
                        example: "11a8ebd3d1b1c404c48d686727e96f1b6689906f87e89442487aa31db4b4b3eb"
        "401":
          description: No Auth
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotUserAuthPermission"

  /v1/common/{constance_type}/type:
    get:
      tags:
        - Common
      summary: Get constance type
      description: Get constance type
      parameters:
        - in: path
          name: constance_type
          required: true
          schema:
            type: string
            enum: [""]
          description: Type of constance_type
      responses:
        "200":
          description: Health Check successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CommonConstanceTypeItemsResponse"

  /v1/payment/product/fail/kakao/{order_token}:
    post:
      tags:
        - Kakao Payment
      summary: Simulate Kakao Pay payment failure
      description: Marks a payment process as failed for an order using Kakao Pay.
      parameters:
        - in: path
          name: order_token
          required: true
          schema:
            type: string
          description: The order token of the payment to mark as failed.
      responses:
        "200":
          description: Payment marked as failed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "결제가 실패되었습니다."
        "400":
          description: Error due to invalid input or non-existent order
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              examples:
                invalid_input:
                  value:
                    message: "입력값을 다시 확인해주세요."
                non_existent_order:
                  value:
                    message: "존재하지 않는 주문입니다."

  /v1/promotion/banners:
    get:
      tags:
        - Promotion
      summary: Get promotion banners
      operationId: getPromotionBanners
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
          description: Page number of the banner list.
        - name: size
          in: query
          required: false
          schema:
            type: integer
            default: 10
          description: Number of banners per page.
        - name: target_layer
          in: query
          required: true
          schema:
            type: string
            enum:
              - HOME_TOP
          description: The target layer of the banners to retrieve.
      responses:
        "200":
          description: A list of promotion banners.
          content:
            application/json:
              schema:
                type: object
                properties:
                  banners:
                    type: array
                    items:
                      type: object
                      properties:
                        banner_id:
                          type: integer
                          nullable: false
                        title:
                          type: string
                          nullable: true
                        title_font_color:
                          type: string
                          nullable: true
                        description:
                          type: string
                          nullable: true
                        description_font_color:
                          type: string
                          nullable: true
                        background_color:
                          type: string
                          nullable: true
                        big_image:
                          type: string
                          nullable: true
                        middle_image:
                          type: string
                          nullable: true
                        small_image:
                          type: string
                          nullable: true
                        action_page:
                          type: string
                          nullable: true
                        target_pk:
                          type: string
                          nullable: true
                        target_type:
                          type: string
                          nullable: true
                        external_target_url:
                          type: string
                          nullable: true
                        tags:
                          type: array
                          items:
                            type: string
              examples:
                example-1:
                  value:
                    {
                      "banners":
                        [
                          {
                            "banner_id": 1,
                            "title": "Example Banner Title",
                            "title_font_color": "#FFFFFF",
                            "description": "Example Description",
                            "description_font_color": "#EEEEEE",
                            "background_color": "#000000",
                            "big_image": "https://example.com/big_image.jpg",
                            "middle_image": "https://example.com/middle_image.jpg",
                            "small_image": "https://example.com/small_image.jpg",
                            "action_page": "https://example.com/action_page",
                            "target_pk": "123",
                            "target_type": "Product",
                            "external_target_url": "https://example.com/external_url",
                            "tags": ["test_tag"],
                          },
                        ],
                    }
        "400":
          description: Bad request, missing or invalid parameters.
          content:
            application/json:
              examples:
                missing_target_layer:
                  value: { "message": "입력값을 다시 확인해주세요." }
                invalid_target_layer:
                  value: { "message": "잘못된 target_layer 입니다." }

  /v1/map:
    get:
      tags:
        - Map
      summary: "[TODO] 전체 Map 목록 조회"
      description: |
        Status: Not Implemented
        Map 목록을 페이지네이션하여 조회합니다.
      parameters:
        - name: cursor
          in: query
          description: base64로 인코딩된 커서 값
          required: false
          schema:
            type: string
        - name: limit
          in: query
          description: 한 번에 가져올 개수
          required: false
          schema:
            type: integer
            default: 20
        - name: search
          in: query
          description: 검색어
          required: false
          schema:
            type: string
        - name: order_by
          in: query
          description: 정렬 기준
          required: false
          schema:
            type: string
            enum: ["created_at", "subscriber_count"]
            default: "created_at"
      responses:
        "200":
          description: 성공적으로 Map 목록을 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      maps:
                        type: array
                        items:
                          $ref: "#/components/schemas/MapListItem"
                      next_cursor:
                        type: string
                        description: base64 인코딩된 다음 커서 값

  /v1/map/{map_id}:
    get:
      tags:
        - Map
      summary: "[TODO] Map 상세 조회"
      description: |
        Status: Not Implemented
        특정 Map의 상세 정보를 조회합니다.
      parameters:
        - name: map_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: 성공적으로 Map 상세 정보를 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    $ref: "#/components/schemas/MapDetail"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "404":
          $ref: "#/components/responses/MapNotFoundError"

  /v1/node/{node_id}:
    get:
      tags:
        - Node
      summary: "[TODO] Node 상세 정보 조회"
      description: |
        Status: Not Implemented
        특정 Node의 상세 정보를 조회합니다.
      parameters:
        - name: node_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: 성공적으로 Node 상세 정보를 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    $ref: "#/components/schemas/NodeDetail"
        "403":
          $ref: "#/components/responses/NodeForbiddenError"
        "404":
          $ref: "#/components/responses/NodeNotFoundError"

  /v1/question/{question_id}/answers:
    post:
      tags:
        - Question
      summary: "[TODO] Question 답변 제출"
      description: |
        Status: Not Implemented
        특정 Question에 대한 답변을 제출합니다.
      parameters:
        - name: question_id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                answer:
                  type: string
                  example: "답변 내용"
                files:
                  type: array
                  items:
                    type: object
                    properties:
                      file:
                        type: string
                        example: "s3/path/to/uploaded/file.html"
      responses:
        "201":
          description: 답변이 성공적으로 제출되었습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "20100000"
                  data:
                    $ref: "#/components/schemas/QuestionAnswerResponse"
        "400":
          $ref: "#/components/responses/QuestionAnswerValidationError"
        "403":
          $ref: "#/components/responses/QuestionAnswerForbiddenError"
        "404":
          $ref: "#/components/responses/QuestionNotFoundError"

  /v1/map-graph/node/{map_id}:
    get:
      tags:
        - MapGraph
      summary: "[TODO] Map의 Node 목록 조회"
      description: |
        Status: Not Implemented
        특정 Map에 속한 모든 Node의 위치와 상태 정보를 조회합니다.
      parameters:
        - name: map_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: 성공적으로 Node 목록을 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      nodes:
                        type: array
                        items:
                          $ref: "#/components/schemas/Node"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "404":
          $ref: "#/components/responses/MapNotFoundError"

  /v1/map-graph/arrow/{map_id}:
    get:
      tags:
        - MapGraph
      summary: "[TODO] Map의 Arrow 목록 조회"
      description: |
        Status: Not Implemented
        특정 Map에 속한 모든 Arrow의 연결 정보와 상태를 조회합니다.
      parameters:
        - name: map_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: 성공적으로 Arrow 목록을 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    properties:
                      arrows:
                        type: array
                        items:
                          $ref: "#/components/schemas/Arrow"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "404":
          $ref: "#/components/responses/MapNotFoundError"

  /v1/map-graph/active-rule/{map_id}:
    get:
      tags:
        - MapGraph
      summary: "[TODO] Map의 ActiveRule 목록 조회"
      description: |
        Status: Not Implemented
        특정 Map에 속한 모든 ActiveRule 정보를 조회합니다.
      parameters:
        - name: map_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: 성공적으로 ActiveRule 목록을 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/ActiveRule"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "404":
          $ref: "#/components/responses/MapNotFoundError"

  /v1/map-graph/meta/{map_id}:
    get:
      tags:
        - MapGraph
      summary: "[TODO] Map 그래프 메타데이터 조회"
      description: |
        Status: Not Implemented
        Map 그래프의 메타데이터를 조회합니다.
      parameters:
        - name: map_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: 성공적으로 메타데이터를 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "성공"
                  data:
                    $ref: "#/components/schemas/MapGraphMeta"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "404":
          $ref: "#/components/responses/MapNotFoundError"

  /v1/map/subscribed:
    get:
      tags:
        - Map
      summary: "[TODO] 구독 중인 Map 목록 조회"
      description: |
        Status: Not Implemented
        사용자가 구독 중인 Map 목록을 페이지네이션하여 조회합니다.
      parameters:
        - name: cursor
          in: query
          description: base64로 인코딩된 커서 값
          required: false
          schema:
            type: string
        - name: limit
          in: query
          description: 한 번에 가져올 개수
          required: false
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: 성공적으로 구독 중인 Map 목록을 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      maps:
                        type: array
                        items:
                          $ref: "#/components/schemas/MapListItem"
                      next_cursor:
                        type: string
                        description: base64 인코딩된 다음 커서 값
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/map/popular:
    get:
      tags:
        - Map
      summary: "[TODO] 인기 Map 목록 조회"
      description: |
        Status: Not Implemented
        구독자 수 기준으로 상위 5개의 인기 Map 목록을 조회합니다.
      responses:
        "200":
          description: 성공적으로 인기 Map 목록을 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      maps:
                        type: array
                        items:
                          $ref: "#/components/schemas/MapListItem"
                        maxItems: 5
                        minItems: 5

  /v1/member/profile:
    get:
      tags:
        - Member
      summary: "[TODO] 내 프로필 조회"
      description: |
        Status: Not Implemented
        로그인한 사용자의 프로필 정보를 조회합니다.
      responses:
        "200":
          description: 프로필 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    $ref: "#/components/schemas/MemberProfile"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

    patch:
      tags:
        - Member
      summary: 프로필 정보 수정
      description: 로그인한 사용자의 프로필 정보를 수정합니다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                  example: "새로운닉네임"
                profile_image:
                  type: string
                  format: binary
                  description: "프로필 이미지 파일 (jpg, png만 가능)"
      responses:
        "200":
          description: 프로필 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: string
                    example: "success"
                  data:
                    $ref: "#/components/schemas/MemberProfile"
        "400":
          description: |
            프로필 수정 실패<br>
            [ status_code ENUM ]<br>
            invalid-profile-field-value<br>
            invalid-file-format<br>
            [ errors ENUM ]<br>
            nickname<br>
            profile_image<br>
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

components:
  schemas:
    NotUserAuthPermission:
      type: object
      required:
        - message
      properties:
        message:
          type: string
          description: "오류 메시지"
          example: "로그인 후 이용해주세요."

    CommonConstanceTypeItemsResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/CommonConstanceTypeItem"

    CommonConstanceTypeItem:
      type: object
      required:
        - id
        - name
        - display_name
      properties:
        id:
          type: integer
          description: type pk
          example: 1
        name:
          type: string
          description: searching for wording
          example: Frontend
        display_name:
          type: string
          description: What user will see
          example: "프론트엔더"

    ErrorSchema:
      type: object
      properties:
        status_code:
          type: string
        message:
          type: string
        errors:
          type: object
          additionalProperties: true

    NodeErrorSchema:
      allOf:
        - $ref: "#/components/schemas/ErrorSchema"
        - type: object
          example:
            status_code: "40430001"
            message: "Node를 찾을 수 없습니다"
            errors: {}

    QuestionErrorSchema:
      allOf:
        - $ref: "#/components/schemas/ErrorSchema"
        - type: object
          example:
            status_code: "40440001"
            message: "Question을 찾을 수 없습니다"
            errors: {}

    QuestionAnswerValidationSchema:
      allOf:
        - $ref: "#/components/schemas/ErrorSchema"
        - type: object
          properties:
            errors:
              type: object
              properties:
                answer:
                  type: array
                  items:
                    type: string
                files:
                  type: array
                  items:
                    type: string
          example:
            status_code: "40040002"
            message: "필수 이 누락되었습니다"
            errors:
              answer: ["답변을 입력해주세요"]
              files: ["파일을 첨부해주세요"]

    ErrorResponse:
      type: object
      required:
        - message
        - status_code
        - errors
      properties:
        message:
          type: string
          description: "큰 에러 범주"
          example: "유효하지 않은 입력값입니다."
        status_code:
          type: string
          description: "큰 에러 코드"
          example: "invalid-username-or-password"
        errors:
          type: object
          nullable: true
          additionalProperties:
            type: array
            items:
              type: string
          example:
            field1: ["에러 메시지1"]
            field2: ["에러 메시지2"]

    MapListItem:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "React 학습 로드맵"
        description:
          type: string
          example: "React 개발자가 되기 위한 단계별 학습 로드맵입니다"
        subscriber_count:
          type: integer
          example: 2345
        view_count:
          type: integer
          example: 2345
        is_subscribed:
          type: boolean
          example: false
        icon_image:
          type: string
          example: "https://s3/path/to/image.jpg"
        background_image:
          type: string
          example: "https://s3/path/to/image.jpg"
        created_by:
          type: object
          properties:
            id:
              type: integer
              example: 1
            nickname:
              type: string
              example: "Alice"
        created_at:
          type: string
          format: date-time
          example: "2024-01-20T00:00:00Z"

    MapDetail:
      allOf:
        - $ref: "#/components/schemas/MapListItem"
        - type: object
          properties:
            background_image:
              type: string
              example: "s3/path/to/image.jpg"
            progress:
              type: object
              properties:
                completed_node_count:
                  type: integer
                  example: 4
                total_node_count:
                  type: integer
                  example: 10
                percentage:
                  type: integer
                  example: 40
                recent_activated_nodes:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      name:
                        type: string
                        example: "HTML 마스터"

    NodeDetail:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "HTML 기초"
        title:
          type: string
          example: "HTML 마스터"
        description:
          type: string
          example: "HTML의 기본 구조와 시맨틱 태그를 이해하고 활용할 수 있습니다"
        background_image:
          type: string
          example: "s3/path/to/image.jpg"
        status:
          type: string
          example: "active"
        statistic:
          type: object
          properties:
            activated_member_count:
              type: integer
              example: 10
            completed_member_count:
              type: integer
              example: 10
        active_rules:
          type: array
          items:
            $ref: "#/components/schemas/NodeActiveRule"

    NodeActiveRule:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "HTML 기초 학습하기"
        progress:
          type: object
          properties:
            completed_questions:
              type: integer
              example: 2
            total_questions:
              type: integer
              example: 5
            percentage:
              type: integer
              example: 40
        questions:
          type: array
          items:
            $ref: "#/components/schemas/NodeQuestion"

    NodeQuestion:
      type: object
      properties:
        id:
          type: integer
          example: 1
        title:
          type: string
          example: "HTML 기초 이해하기"
        description:
          type: string
          example: "HTML의 기본 구조와 태그들의 의미를 이해합니다"
        status:
          type: string
          enum: ["completed", "in_progress", "locked"]
          example: "completed"
        by_node_id:
          type: integer
          example: 1
        answer_submit_with_text:
          type: boolean
          example: true
        answer_submit_with_file:
          type: boolean
          example: true
        my_answers:
          type: array
          items:
            $ref: "#/components/schemas/UserQuestionAnswer"

    UserQuestionAnswer:
      type: object
      properties:
        id:
          type: integer
          example: 1
        answer:
          type: string
          example: "제출한 답변 내용"
        is_correct:
          type: boolean
          nullable: true
          example: true
        feedback:
          type: string
          example: "관리자의 피드백 내용"
        reviewed_by:
          type: object
          properties:
            id:
              type: integer
              example: 1
            nickname:
              type: string
              example: "Admin"
        reviewed_at:
          type: string
          format: date-time
          example: "2024-01-21T00:00:00Z"
        submitted_at:
          type: string
          format: date-time
          example: "2024-01-20T00:00:00Z"
        files:
          type: array
          items:
            $ref: "#/components/schemas/QuestionAnswerFile"

    QuestionAnswerFile:
      type: object
      properties:
        id:
          type: integer
          example: 1
        file:
          type: string
          example: "s3/path/to/file.html"

    QuestionAnswerResponse:
      type: object
      properties:
        id:
          type: integer
          example: 1
        answer:
          type: string
          example: "답변 내용"
        submitted_at:
          type: string
          format: date-time
          example: "2024-01-20T00:00:00Z"
        validation_type:
          type: string
          enum: ["auto", "manual"]
          example: "auto"
        status:
          type: string
          enum: ["completed", "failed", "pending_review"]
          example: "completed"
        feedback:
          type: string
          nullable: true
          example: "정답입니다! HTML의 기본 구조를 잘 이해하고 있습니다."

    MapGraphMeta:
      type: object
      properties:
        id:
          type: integer
          example: 1
        title:
          type: string
          example: "React 학습 로드맵"
        description:
          type: string
          example: "React의 기초부터 심화까지 학습하는 로드맵입니다"
        stats:
          type: object
          properties:
            total_nodes:
              type: integer
              example: 9
            completed_nodes:
              type: integer
              example: 3
            learning_period:
              type: object
              properties:
                start_date:
                  type: string
                  format: date-time
                  example: "2024-01-01T00:00:00Z"
                days:
                  type: integer
                  example: 60
            total_questions:
              type: integer
              example: 25
            solved_questions:
              type: integer
              example: 12
        layout:
          type: object
          properties:
            width:
              type: integer
              example: 3000
            height:
              type: integer
              example: 3000
            grid_size:
              type: integer
              example: 20
        theme:
          type: object
          properties:
            background_color:
              type: string
              example: "#f8f9fa"
            grid_color:
              type: string
              example: "#ddd"
            node:
              type: object
              properties:
                completed:
                  $ref: "#/components/schemas/NodeTheme"
                in_progress:
                  $ref: "#/components/schemas/NodeTheme"
                locked:
                  $ref: "#/components/schemas/NodeTheme"
            arrow:
              type: object
              properties:
                completed:
                  type: string
                  example: "#4CAF50"
                in_progress:
                  type: string
                  example: "#2196F3"
                locked:
                  type: string
                  example: "#666666"
        version:
          type: string
          example: "20240301120532"

    NodeTheme:
      type: object
      properties:
        background:
          type: string
          example: "#FFFFFF"
        border:
          type: string
          example: "#4CAF50"
        text:
          type: string
          example: "#4CAF50"
        icon:
          type: string
          example: "checkmark-circle"

    Node:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "HTML 기초"
        position_x:
          type: number
          example: 100
        position_y:
          type: number
          example: 100
        status:
          type: string
          enum: ["completed", "in_progress", "locked"]
          example: "completed"

    Arrow:
      type: object
      properties:
        id:
          type: integer
          example: 1
        start_node_id:
          type: integer
          example: 1
        end_node_id:
          type: integer
          example: 2
        active_rule_id:
          type: integer
          example: 1
        status:
          type: string
          enum: ["completed", "in_progress", "locked"]
          example: "completed"

    ActiveRule:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "HTML 기초 완료"
        target_nodes:
          type: array
          items:
            type: integer
          example: [2]

    MemberProfile:
      type: object
      properties:
        id:
          type: integer
          example: 1
        nickname:
          type: string
          example: "John"
        profile_image:
          type: string
          example: "s3/path/to/profile/image.jpg"
        subscribed_map_count:
          type: integer
          example: 5
        created_at:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00Z"

  responses:
    UnauthorizedError:
      description: 인증되지 않은 사용자
      content:
        application/json:
          schema:
            type: object
            properties:
              status_code:
                type: string
                example: "40110001"
              message:
                type: string
                example: "로그인이 필요한 서비스입니다"
              errors:
                type: object
                example: {}

    MapNotFoundError:
      description: 존재하지 않는 Map
      content:
        application/json:
          schema:
            type: object
            properties:
              status_code:
                type: string
                example: "40420001"
              message:
                type: string
                example: "Map을 찾을 수 없습니다"
              errors:
                type: object
                example: {}

    NodeForbiddenError:
      description: Node 접근 권한이 없음
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/NodeErrorSchema"
          example:
            status_code: "40330001"
            message: "해당 Node에 접근할 수 없습니다"
            errors: {}

    NodeNotFoundError:
      description: 존재하지 않는 Node
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/NodeErrorSchema"

    QuestionNotFoundError:
      description: 존재하지 않는 Question
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/QuestionErrorSchema"

    QuestionAnswerValidationError:
      description: Question 답변 유효성 검증 실패
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/QuestionAnswerValidationSchema"

    QuestionAnswerForbiddenError:
      description: Question 답변 권한이 없음
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorSchema"
          example:
            status_code: "40340001"
            message: "답변을 제출할 권한이 없습니다"
            errors: {}
